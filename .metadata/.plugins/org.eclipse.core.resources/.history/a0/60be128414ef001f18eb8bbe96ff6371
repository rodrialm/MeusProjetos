package proativa.projeto.modelo;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

import javafx.event.ActionEvent;
import javafx.stage.FileChooser;
import javafx.stage.Stage;

public class Arquivo {

	private String nomeArquivo;
	File arquivoSelecionado;

	public Arquivo() {

	}

	public Arquivo(ActionEvent event) throws Exception {
		buscarArquivo(event);
	}

	public void buscarArquivo(ActionEvent event) {

		try {
			FileChooser selecionarArquivo = new FileChooser();
			selecionarArquivo.setTitle("Selecionar Arquivo Excel");
			selecionarArquivo.getExtensionFilters()
					.addAll(new FileChooser.ExtensionFilter("Arquivos Excel", "*.xls", "*.xlsx" , "*"));
			Stage stage = (Stage) ((javafx.scene.Node) event.getSource()).getScene().getWindow();
			this.arquivoSelecionado = selecionarArquivo.showOpenDialog(stage);
			nomeArquivo = arquivoSelecionado.getName();
			System.out.println(this.nomeArquivo.endsWith(".xls") || this.nomeArquivo.endsWith(".xlsx"));
				
			if (arquivoSelecionado != null) {
				try {
					String nomeArquivo = arquivoSelecionado.getName();
					if (nomeArquivo.endsWith(".xls") || nomeArquivo.endsWith(".xlsx")) {

					} else {
						nomeArquivo = "Formato invalido";
					}
				} catch (Exception e) {
					System.out.println(e.getMessage());
				}
			}

		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
		
	}

	public void lerArquivo() {
		try(FileInputStream arquivo = new FileInputStream(arquivoSelecionado)){
		}catch (Exception e) {
			
		}
		
	}

	public String getNome() {
		if (nomeArquivo != null) {
			return nomeArquivo;
		} else {
			return "Arquivo n√£o selecionado!";
		}
	}
}
