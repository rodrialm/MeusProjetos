package proativa.projeto.modelo;

import java.io.File;

import javafx.application.Application;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.TextArea;
import javafx.stage.FileChooser;
import javafx.stage.Stage;

public class Controlador extends Application{
	
	private String arquivo = "C:\\Users\\Rodrigo\\Documents\\lista.xlsx";
    private TextArea textArea;
	
	@FXML
	public void buscarArquivo() {
			
			Button botao = new Button("Selecionar arquivo");
			botao.setOnAction(e -> buscarArquivo(primaryStage));
	    
	        FileChooser fileChooser = new FileChooser();
	        fileChooser.setTitle("Selecionar Arquivo Excel");
	        fileChooser.getExtensionFilters().addAll(
	                new FileChooser.ExtensionFilter("Arquivos Excel", "*.xls", "*.xlsm")
	        );
//	        File arquivoSelecionado = fileChooser.showOpenDialog(primaryStage);
//
//	        if (arquivoSelecionado != null) {
//	            try {
//	                // Verifica a extensão do arquivo
//	                String nomeArquivo = arquivoSelecionado.getName();
//	                if (nomeArquivo.endsWith(".xls") || nomeArquivo.endsWith(".xlsm")) {
//	                    // Lê o arquivo Excel
//	                    String conteudo = lerArquivoExcel(arquivoSelecionado);
//	                    textArea.setText(conteudo);
//	                } else {
//	                    exibirAlerta("Formato inválido", "O arquivo selecionado não é um Excel válido.");
//	                }
//	            } catch (IOException e) {
//	                exibirAlerta("Erro", "Erro ao ler o arquivo: " + e.getMessage());
//	            }
//	        }
	    
		
		System.out.println("Buscando Arquivo...");
	}
	
//	
//	   private String lerArquivoExcel(File arquivo) throws IOException {
//	        StringBuilder conteudo = new StringBuilder();
//	        FileInputStream fileInputStream = new FileInputStream(arquivo);
//	        Workbook workbook;
//
//	        // Verifica se é .xls ou .xlsm
//	        if (arquivo.getName().endsWith(".xls")) {
//	            workbook = new HSSFWorkbook(fileInputStream); // Para .xls
//	        } else {
//	            workbook = new XSSFWorkbook(fileInputStream); // Para .xlsm
//	        }
//
//	        // Lê a primeira planilha
//	        Sheet sheet = workbook.getSheetAt(0);
//	        for (Row row : sheet) {
//	            for (Cell cell : row) {
//	                // Converte o conteúdo da célula para String
//	                switch (cell.getCellType()) {
//	                    case STRING:
//	                        conteudo.append(cell.getStringCellValue()).append("\t");
//	                        break;
//	                    case NUMERIC:
//	                        conteudo.append(cell.getNumericCellValue()).append("\t");
//	                        break;
//	                    case BOOLEAN:
//	                        conteudo.append(cell.getBooleanCellValue()).append("\t");
//	                        break;
//	                    default:
//	                        conteudo.append("-\t");
//	                }
//	            }
//	            conteudo.append("\n");
//	        }
//
//	        workbook.close();
//	        fileInputStream.close();
//	        return conteudo.toString();
//	    }
//
//	    private void exibirAlerta(String titulo, String mensagem) {
//	        Alert alert = new Alert(AlertType.ERROR);
//	        alert.setTitle(titulo);
//	        alert.setHeaderText(null);
//	        alert.setContentText(mensagem);
//	        alert.showAndWait();
//	    }
	
	@FXML
	public void lerArquivo() {
		System.out.println("Lendo Arquivo...");
	}
}
